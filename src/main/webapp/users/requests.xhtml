<ui:composition template="/WEB-INF/template.xhtml"
				xmlns="http://www.w3.org/1999/xhtml"
				xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:p="http://primefaces.org/ui"
				xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
	<ui:define name="sidebar">
		<h:form>
			<p:remoteCommand actionListener="#{transferRequestsBean.loadAllRequests()}"
							 update="requestForm"
							 autoRun="true"/>
			<p:remoteCommand action="#{layout.setLoading(false)}"
							 name="setLoadingFalse"
							 update="progressBarIndeterminate"/>
			<p:remoteCommand action="#{layout.setLoading(true)}"
							 name="setLoadingTrue"
							 update="progressBarIndeterminate"/>
		</h:form>
		<p:panelGrid>
			<div class="p-grid p-align-center" style="text-align: center">
				<p:linkButton outcome="transactions" value="Transactions" class="p-col-12 p-col-align-center"/>
				<p:linkButton outcome="transferPage" value="Transfer / Request Money" class="p-col-12 p-col-align-center"/>
				<p:linkButton outcome="requests" value="Approve / Decline requests" class="p-col-12 p-col-align-center"/>
			</div>
		</p:panelGrid>
	</ui:define>
	<ui:define name="content">

		<div class="ui-g">
			<h4>Approve / Reject transfer requests</h4>
			<p:progressBar styleClass="ui-g-12" rendered="#{layout.loading}" id="progressBarIndeterminate" style="height:6px;"
						   mode="indeterminate">
			</p:progressBar>
			<h:form id="requestForm" styleClass="ui-g-12">
				<p:autoUpdate/>
				<h:outputLabel for="multiple" value="Requests:"  styleClass="ui-g-3"/>
				<p:selectCheckboxMenu styleClass="ui-g-7" id="multiple" value="#{transferRequestsBean.selectedTransactions}" label="Requests" multiple="true"
									  filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
					<f:selectItems var="t" value="#{transferRequestsBean.transactions}" itemLabel="#{t.amount}: #{t.transactionOwner.username}" />
				</p:selectCheckboxMenu>
				<span class="ui-g-12" />
				<p:commandButton
						process="@this, requestForm"
						onstart="setLoadingTrue()"
						oncomplete="setLoadingFalse()"
						value="Approve Selected"
						ajax="false"
						update="requestForm"
						action="#{transferRequestsBean.approveSelected()}"/>
				<p:commandButton
						process="@this, requestForm"
						onstart="setLoadingTrue()"
						oncomplete="setLoadingFalse()"
						value="Reject Selected"
						ajax="false"
						update="requestForm"
						action="#{transferRequestsBean.rejectSelected()}"/>
			</h:form>
		</div>
	</ui:define>
</ui:composition>